<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>益智题挑战</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5',
                        secondary: '#10B981',
                        accent: '#F59E0B',
                        danger: '#EF4444',
                        dark: '#1F2937',
                        light: '#F3F4F6',
                        types: {
                            math: '#3B82F6',
                            logic: '#EC4899',
                            trivia: '#10B981',
                            word: '#8B5CF6',
                            life: '#F59E0B',
                            fun: '#6366F1',
                            number: '#F97316'
                        }
                    },
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .card-hover {
                transition: all 0.3s ease;
            }
            .card-hover:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            }
            .question-card {
                transition: all 0.5s ease;
            }
            .question-card:hover {
                transform: translateY(-3px);
                box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            }
            .scale-in {
                animation: scaleIn 0.5s ease forwards;
            }
            @keyframes scaleIn {
                0% { transform: scale(0.95); opacity: 0; }
                100% { transform: scale(1); opacity: 1; }
            }
            .fade-in {
                animation: fadeIn 0.5s ease forwards;
            }
            @keyframes fadeIn {
                0% { opacity: 0; }
                100% { opacity: 1; }
            }
        }
    </style>
    <style>
        /* 针对移动设备的额外优化 */
        @media (max-width: 640px) {
            html {
                font-size: 14px;
            }
            
            .container {
                padding-left: 0.75rem !important;
                padding-right: 0.75rem !important;
            }
            
            #game-container {
                padding: 1.5rem !important;
            }
            
            .btn-mobile {
                padding: 0.75rem 1.5rem !important;
                font-size: 1rem !important;
            }
            
            #question {
                font-size: 1.75rem !important;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-50 to-purple-50 min-h-screen font-inter text-dark">
    <div class="container mx-auto px-4 py-6 max-w-4xl">
        <!-- 游戏标题 -->
        <header class="text-center mb-6">
            <h1 class="text-[clamp(1.5rem,4vw,2.5rem)] font-bold text-primary mb-2 text-shadow">益智题挑战</h1>
            <p class="text-gray-600">测试你的综合能力，挑战无限AI生成的益智题目！</p>
        </header>

        <!-- 游戏状态 -->
        <div class="flex flex-wrap gap-3 justify-center mb-6">
            <div class="bg-white rounded-xl shadow-lg p-3 w-[45%] flex items-center justify-center card-hover">
                <i class="fa fa-trophy text-accent text-xl mr-2"></i>
                <div>
                    <p class="text-gray-500 text-xs">得分</p>
                    <p id="score" class="text-xl font-bold">0</p>
                </div>
            </div>
            
            <div class="bg-white rounded-xl shadow-lg p-3 w-[45%] flex items-center justify-center card-hover">
                <i class="fa fa-clock-o text-danger text-xl mr-2"></i>
                <div>
                    <p class="text-gray-500 text-xs">剩余时间</p>
                    <p id="timer" class="text-xl font-bold">10</p>
                </div>
            </div>
            
            <div class="bg-white rounded-xl shadow-lg p-3 w-[45%] flex items-center justify-center card-hover">
                <i class="fa fa-signal text-secondary text-xl mr-2"></i>
                <div>
                    <p class="text-gray-500 text-xs">难度</p>
                    <p id="difficulty" class="text-xl font-bold">简单</p>
                </div>
            </div>
            
            <div id="question-type-indicator" class="bg-white rounded-xl shadow-lg p-3 w-[45%] flex items-center justify-center card-hover">
                <i id="type-icon" class="fa fa-calculator text-types-math text-xl mr-2"></i>
                <div>
                    <p class="text-gray-500 text-xs">题目类型</p>
                    <p id="question-type" class="text-xl font-bold">数学运算</p>
                </div>
            </div>
        </div>

        <!-- 游戏区域 -->
        <div id="game-container" class="bg-white rounded-2xl shadow-xl p-6 mb-6 transform transition-all duration-500 question-card">
            <div id="question-container" class="text-center mb-6">
                <p class="text-gray-600 mb-2">当前题目</p>
                <p id="question" class="text-2xl md:text-3xl font-bold mb-4">3 + 5 = ?</p>
                
                <div id="options-container" class="flex flex-col sm:flex-row gap-3 justify-center mb-6">
                    <button id="option1" class="bg-primary hover:bg-primary/90 text-white font-bold py-2 px-6 rounded-full transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary/50 shadow-lg btn-mobile">8</button>
                    <button id="option2" class="bg-primary hover:bg-primary/90 text-white font-bold py-2 px-6 rounded-full transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary/50 shadow-lg btn-mobile">9</button>
                    <button id="option3" class="bg-primary hover:bg-primary/90 text-white font-bold py-2 px-6 rounded-full transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary/50 shadow-lg btn-mobile">7</button>
                </div>
                
                <div id="input-answer-container" class="hidden mb-6">
                    <input type="text" id="input-answer" placeholder="输入你的答案..." class="w-full max-w-md mx-auto px-4 py-2 rounded-lg border-2 border-gray-300 focus:border-primary focus:ring focus:ring-primary/20 outline-none transition-all">
                    <button id="submit-answer" class="mt-3 bg-primary hover:bg-primary/90 text-white font-bold py-2 px-6 rounded-full transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary/50 shadow-lg btn-mobile">
                        提交答案
                    </button>
                </div>
            </div>
            
            <div id="feedback" class="text-center h-8 mb-3"></div>
            
            <div id="progress-container" class="h-3 w-full bg-gray-200 rounded-full overflow-hidden">
                <div id="progress-bar" class="h-full bg-gradient-to-r from-secondary to-primary transition-all duration-300" style="width: 100%"></div>
            </div>
        </div>

        <!-- 游戏控制 -->
        <div class="flex flex-wrap gap-3 justify-center mb-6">
            <button id="start-btn" class="bg-secondary hover:bg-secondary/90 text-white font-bold py-2 px-6 rounded-full transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-secondary/50 shadow-lg btn-mobile">
                <i class="fa fa-play mr-2"></i>开始游戏
            </button>
            <button id="restart-btn" class="bg-accent hover:bg-accent/90 text-white font-bold py-2 px-6 rounded-full transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-accent/50 shadow-lg hidden btn-mobile">
                <i class="fa fa-refresh mr-2"></i>重新开始
            </button>
            <button id="settings-btn" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-6 rounded-full transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-500/50 shadow-lg btn-mobile">
                <i class="fa fa-cog mr-2"></i>设置
            </button>
        </div>

        <!-- 设置模态框 -->
        <div id="settings-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-2xl shadow-2xl p-5 max-w-md w-full mx-3 transform transition-all duration-300 scale-95 opacity-0" id="modal-content">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-primary">游戏设置</h2>
                    <button id="close-settings" class="text-gray-500 hover:text-gray-700 focus:outline-none">
                        <i class="fa fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2 font-medium">题目类型</label>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                        <label class="flex items-center p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                            <input type="checkbox" name="question-types" value="math" checked class="mr-2 h-4 w-4 text-types-math focus:ring-types-math rounded">
                            <span class="flex items-center">
                                <i class="fa fa-calculator text-types-math mr-2"></i>
                                数学运算
                            </span>
                        </label>
                        <label class="flex items-center p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                            <input type="checkbox" name="question-types" value="logic" checked class="mr-2 h-4 w-4 text-types-logic focus:ring-types-logic rounded">
                            <span class="flex items-center">
                                <i class="fa fa-puzzle-piece text-types-logic mr-2"></i>
                                逻辑思维
                            </span>
                        </label>
                        <label class="flex items-center p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                            <input type="checkbox" name="question-types" value="trivia" checked class="mr-2 h-4 w-4 text-types-trivia focus:ring-types-trivia rounded">
                            <span class="flex items-center">
                                <i class="fa fa-lightbulb-o text-types-trivia mr-2"></i>
                                脑筋急转弯
                            </span>
                        </label>
                        <label class="flex items-center p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                            <input type="checkbox" name="question-types" value="word" checked class="mr-2 h-4 w-4 text-types-word focus:ring-types-word rounded">
                            <span class="flex items-center">
                                <i class="fa fa-book text-types-word mr-2"></i>
                                文字理解
                            </span>
                        </label>
                        <label class="flex items-center p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                            <input type="checkbox" name="question-types" value="life" checked class="mr-2 h-4 w-4 text-types-life focus:ring-types-life rounded">
                            <span class="flex items-center">
                                <i class="fa fa-home text-types-life mr-2"></i>
                                生活常识
                            </span>
                        </label>
                        <label class="flex items-center p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                            <input type="checkbox" name="question-types" value="fun" checked class="mr-2 h-4 w-4 text-types-fun focus:ring-types-fun rounded">
                            <span class="flex items-center">
                                <i class="fa fa-smile-o text-types-fun mr-2"></i>
                                趣味推理
                            </span>
                        </label>
                        <label class="flex items-center p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                            <input type="checkbox" name="question-types" value="number" checked class="mr-2 h-4 w-4 text-types-number focus:ring-types-number rounded">
                            <span class="flex items-center">
                                <i class="fa fa-superscript text-types-number mr-2"></i>
                                数字推理
                            </span>
                        </label>
                    </div>
                </div>
                
                <div class="mb-4">
                    <label for="time-limit" class="block text-gray-700 mb-2 font-medium">每题时间限制 (秒)</label>
                    <input type="range" id="time-limit" min="5" max="30" value="10" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary">
                    <div class="flex justify-between text-sm text-gray-500 mt-1">
                        <span>5秒</span>
                        <span id="time-value">10秒</span>
                        <span>30秒</span>
                    </div>
                </div>
                
                <div class="mb-4">
                    <label for="difficulty-setting" class="block text-gray-700 mb-2 font-medium">难度级别</label>
                    <select id="difficulty-setting" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary">
                        <option value="easy">简单</option>
                        <option value="medium">中等</option>
                        <option value="hard">困难</option>
                    </select>
                </div>
                
                <div class="flex justify-end">
                    <button id="save-settings" class="bg-primary hover:bg-primary/90 text-white font-bold py-2 px-5 rounded-full transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary/50 shadow-lg">
                        保存设置
                    </button>
                </div>
            </div>
        </div>

        <!-- 游戏结束模态框 -->
        <div id="game-over-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-2xl shadow-2xl p-5 max-w-md w-full mx-3 transform transition-all duration-300 scale-95 opacity-0" id="game-over-content">
                <div class="text-center mb-4">
                    <div class="inline-flex items-center justify-center w-14 h-14 rounded-full bg-accent/20 mb-3">
                        <i class="fa fa-trophy text-accent text-2xl"></i>
                    </div>
                    <h2 class="text-xl font-bold text-primary mb-2">游戏结束!</h2>
                    <p class="text-gray-600">你的表现很棒!</p>
                </div>
                
                <div class="mb-4">
                    <div class="flex justify-between items-center mb-2 p-2 bg-gray-50 rounded-lg">
                        <span class="text-gray-700">最终得分</span>
                        <span id="final-score" class="text-xl font-bold text-primary">0</span>
                    </div>
                    <div class="flex justify-between items-center mb-2 p-2 bg-gray-50 rounded-lg">
                        <span class="text-gray-700">答对题目</span>
                        <span id="correct-answers" class="text-lg font-bold text-secondary">0</span>
                    </div>
                    <div class="flex justify-between items-center p-2 bg-gray-50 rounded-lg">
                        <span class="text-gray-700">答错题目</span>
                        <span id="wrong-answers" class="text-lg font-bold text-danger">0</span>
                    </div>
                </div>
                
                <div class="flex flex-col sm:flex-row gap-3 justify-center">
                    <button id="play-again" class="bg-primary hover:bg-primary/90 text-white font-bold py-2 px-5 rounded-full transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary/50 shadow-lg">
                        <i class="fa fa-refresh mr-2"></i>再玩一次
                    </button>
                    <button id="share-result" class="bg-accent hover:bg-accent/90 text-white font-bold py-2 px-5 rounded-full transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-accent/50 shadow-lg">
                        <i class="fa fa-share-alt mr-2"></i>分享结果
                    </button>
                </div>
            </div>
        </div>

        <!-- 页脚 -->
        <footer class="text-center text-gray-500 mt-8 text-sm">
            <p>© 2025 益智题挑战 | 训练你的大脑</p>
        </footer>
    </div>

    <script>
        // 游戏状态
        const gameState = {
            score: 0,
            timeLeft: 10,
            timerInterval: null,
            isPlaying: false,
            currentQuestion: null,
            correctAnswers: 0,
            wrongAnswers: 0,
            difficulty: 'easy',
            questionTypes: ['math', 'logic', 'trivia', 'word', 'life', 'fun', 'number'],
            timeLimit: 10
        };

        // 题目类型配置
        const questionTypeConfig = {
            math: {
                name: '数学运算',
                icon: 'fa-calculator',
                color: 'text-types-math',
                buttonColor: 'bg-types-math'
            },
            logic: {
                name: '逻辑思维',
                icon: 'fa-puzzle-piece',
                color: 'text-types-logic',
                buttonColor: 'bg-types-logic'
            },
            trivia: {
                name: '脑筋急转弯',
                icon: 'fa-lightbulb-o',
                color: 'text-types-trivia',
                buttonColor: 'bg-types-trivia'
            },
            word: {
                name: '文字理解',
                icon: 'fa-book',
                color: 'text-types-word',
                buttonColor: 'bg-types-word'
            },
            life: {
                name: '生活常识',
                icon: 'fa-home',
                color: 'text-types-life',
                buttonColor: 'bg-types-life'
            },
            fun: {
                name: '趣味推理',
                icon: 'fa-smile-o',
                color: 'text-types-fun',
                buttonColor: 'bg-types-fun'
            },
            number: {
                name: '数字推理',
                icon: 'fa-superscript',
                color: 'text-types-number',
                buttonColor: 'bg-types-number'
            }
        };

        // DOM 元素
        const startBtn = document.getElementById('start-btn');
        const restartBtn = document.getElementById('restart-btn');
        const settingsBtn = document.getElementById('settings-btn');
        const closeSettingsBtn = document.getElementById('close-settings');
        const saveSettingsBtn = document.getElementById('save-settings');
        const playAgainBtn = document.getElementById('play-again');
        const shareResultBtn = document.getElementById('share-result');
        const scoreDisplay = document.getElementById('score');
        const timerDisplay = document.getElementById('timer');
        const difficultyDisplay = document.getElementById('difficulty');
        const questionDisplay = document.getElementById('question');
        const optionButtons = [
            document.getElementById('option1'),
            document.getElementById('option2'),
            document.getElementById('option3')
        ];
        const optionsContainer = document.getElementById('options-container');
        const inputAnswerContainer = document.getElementById('input-answer-container');
        const inputAnswer = document.getElementById('input-answer');
        const submitAnswer = document.getElementById('submit-answer');
        const feedbackDisplay = document.getElementById('feedback');
        const progressBar = document.getElementById('progress-bar');
        const gameContainer = document.getElementById('game-container');
        const settingsModal = document.getElementById('settings-modal');
        const modalContent = document.getElementById('modal-content');
        const gameOverModal = document.getElementById('game-over-modal');
        const gameOverContent = document.getElementById('game-over-content');
        const finalScoreDisplay = document.getElementById('final-score');
        const correctAnswersDisplay = document.getElementById('correct-answers');
        const wrongAnswersDisplay = document.getElementById('wrong-answers');
        const timeLimitSlider = document.getElementById('time-limit');
        const timeValueDisplay = document.getElementById('time-value');
        const difficultySetting = document.getElementById('difficulty-setting');
        const questionTypeCheckboxes = document.querySelectorAll('input[name="question-types"]');
        const questionTypeIndicator = document.getElementById('question-type-indicator');
        const questionTypeDisplay = document.getElementById('question-type');
        const typeIcon = document.getElementById('type-icon');

        // 初始化事件监听器
        function initEventListeners() {
            startBtn.addEventListener('click', startGame);
            restartBtn.addEventListener('click', restartGame);
            settingsBtn.addEventListener('click', openSettings);
            closeSettingsBtn.addEventListener('click', closeSettings);
            saveSettingsBtn.addEventListener('click', saveSettings);
            playAgainBtn.addEventListener('click', restartGame);
            shareResultBtn.addEventListener('click', shareResult);
            timeLimitSlider.addEventListener('input', updateTimeValue);
            optionButtons.forEach(button => button.addEventListener('click', checkAnswer));
            submitAnswer.addEventListener('click', checkInputAnswer);
            
            // 模态框动画
            settingsModal.addEventListener('click', (e) => {
                if (e.target === settingsModal) closeSettings();
            });
            
            gameOverModal.addEventListener('click', (e) => {
                if (e.target === gameOverModal) closeGameOverModal();
            });
        }

        // 更新时间显示
        function updateTimeValue() {
            timeValueDisplay.textContent = `${timeLimitSlider.value}秒`;
        }

        // 开始游戏
        function startGame() {
            gameState.isPlaying = true;
            startBtn.classList.add('hidden');
            restartBtn.classList.remove('hidden');
            gameState.score = 0;
            gameState.correctAnswers = 0;
            gameState.wrongAnswers = 0;
            updateScore();
            generateQuestion();
            startTimer();
            
            // 添加游戏开始动画
            gameContainer.classList.add('animate-pulse');
            setTimeout(() => {
                gameContainer.classList.remove('animate-pulse');
            }, 1000);
        }

        // 重新开始游戏
        function restartGame() {
            clearInterval(gameState.timerInterval);
            gameState.timeLeft = gameState.timeLimit;
            timerDisplay.textContent = gameState.timeLeft;
            progressBar.style.width = '100%';
            closeGameOverModal();
            startGame();
        }

        // 打开设置
        function openSettings() {
            // 填充当前设置
            difficultySetting.value = gameState.difficulty;
            timeLimitSlider.value = gameState.timeLimit;
            updateTimeValue();
            
            // 勾选当前问题类型
            questionTypeCheckboxes.forEach(checkbox => {
                checkbox.checked = gameState.questionTypes.includes(checkbox.value);
            });
            
            settingsModal.classList.remove('hidden');
            setTimeout(() => {
                modalContent.classList.remove('scale-95', 'opacity-0');
                modalContent.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        // 关闭设置
        function closeSettings() {
            modalContent.classList.remove('scale-100', 'opacity-100');
            modalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                settingsModal.classList.add('hidden');
            }, 300);
        }

        // 保存设置
        function saveSettings() {
            // 更新难度
            gameState.difficulty = difficultySetting.value;
            difficultyDisplay.textContent = gameState.difficulty.charAt(0).toUpperCase() + gameState.difficulty.slice(1);
            
            // 更新时间限制
            gameState.timeLimit = parseInt(timeLimitSlider.value);
            gameState.timeLeft = gameState.timeLimit;
            timerDisplay.textContent = gameState.timeLeft;
            
            // 更新问题类型
            gameState.questionTypes = Array.from(questionTypeCheckboxes)
                .filter(checkbox => checkbox.checked)
                .map(checkbox => checkbox.value);
            
            // 如果没有选择任何问题类型，默认选择数学运算
            if (gameState.questionTypes.length === 0) {
                gameState.questionTypes = ['math'];
                document.querySelector('input[name="question-types"][value="math"]').checked = true;
            }
            
            closeSettings();
        }

        // 分享结果
        function shareResult() {
            // 模拟分享功能
            if (navigator.share) {
                navigator.share({
                    title: '益智题挑战',
                    text: `我在益智题挑战中得了${gameState.score}分！你也来试试吧！`,
                    url: window.location.href
                })
                .catch(error => console.log('分享失败:', error));
            } else {
                alert(`复制此链接分享: ${window.location.href}\n\n你的得分: ${gameState.score}`);
            }
        }

        // 关闭游戏结束模态框
        function closeGameOverModal() {
            gameOverContent.classList.remove('scale-100', 'opacity-100');
            gameOverContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                gameOverModal.classList.add('hidden');
            }, 300);
        }

        // 开始计时器
        function startTimer() {
            clearInterval(gameState.timerInterval);
            gameState.timeLeft = gameState.timeLimit;
            timerDisplay.textContent = gameState.timeLeft;
            progressBar.style.width = '100%';
            
            gameState.timerInterval = setInterval(() => {
                gameState.timeLeft--;
                timerDisplay.textContent = gameState.timeLeft;
                const percentage = (gameState.timeLeft / gameState.timeLimit) * 100;
                progressBar.style.width = `${percentage}%`;
                
                // 时间快用完时的视觉提示
                if (gameState.timeLeft <= 3) {
                    timerDisplay.classList.add('text-danger');
                    timerDisplay.classList.add('animate-pulse');
                } else {
                    timerDisplay.classList.remove('text-danger');
                    timerDisplay.classList.remove('animate-pulse');
                }
                
                if (gameState.timeLeft <= 0) {
                    clearInterval(gameState.timerInterval);
                    handleWrongAnswer();
                }
            }, 1000);
        }

        // 更新分数显示
        function updateScore() {
            scoreDisplay.textContent = gameState.score;
        }

        // 生成问题
        function generateQuestion() {
            // 随机选择问题类型
            const questionType = gameState.questionTypes[Math.floor(Math.random() * gameState.questionTypes.length)];
            
            // 更新问题类型指示器
            updateQuestionTypeIndicator(questionType);
            
            let questionData;
            
            // 根据问题类型生成题目
            switch (questionType) {
                case 'math':
                    questionData = generateMathQuestion();
                    break;
                case 'logic':
                    questionData = generateLogicQuestion();
                    break;
                case 'trivia':
                    questionData = generateTriviaQuestion();
                    break;
                case 'word':
                    questionData = generateWordQuestion();
                    break;
                case 'life':
                    questionData = generateLifeQuestion();
                    break;
                case 'fun':
                    questionData = generateFunQuestion();
                    break;
                case 'number':
                    questionData = generateNumberSequenceQuestion();
                    break;
                default:
                    questionData = {
                        question: "默认问题",
                        answer: "默认答案",
                        options: ["选项1", "选项2", "选项3"]
                    };
            }
            
            // 保存当前问题
            gameState.currentQuestion = {
                ...questionData,
                type: questionType
            };
            
            // 更新UI
            questionDisplay.textContent = questionData.question;
            
            // 根据问题类型决定显示选项还是输入框
            if (questionData.options) {
                // 随机排序选项
                const shuffledOptions = [...questionData.options].sort(() => Math.random() - 0.5);
                
                // 更新选项按钮
                optionButtons.forEach((button, index) => {
                    button.textContent = shuffledOptions[index];
                    button.disabled = false;
                    button.classList.remove('bg-secondary', 'bg-danger', 'opacity-70');
                    button.classList.add(questionTypeConfig[questionType].buttonColor);
                });
                
                // 显示选项容器，隐藏输入容器
                optionsContainer.classList.remove('hidden');
                inputAnswerContainer.classList.add('hidden');
            } else {
                // 隐藏选项容器，显示输入容器
                optionsContainer.classList.add('hidden');
                inputAnswerContainer.classList.remove('hidden');
                inputAnswer.value = '';
                inputAnswer.focus();
            }
            
            // 添加问题出现动画
            gameContainer.classList.add('scale-in');
            setTimeout(() => {
                gameContainer.classList.remove('scale-in');
            }, 500);
            
            // 重置反馈
            feedbackDisplay.textContent = '';
        }

        // 更新问题类型指示器
        function updateQuestionTypeIndicator(type) {
            const config = questionTypeConfig[type];
            questionTypeDisplay.textContent = config.name;
            questionTypeDisplay.className = `text-xl font-bold ${config.color}`;
            typeIcon.className = `fa ${config.icon} ${config.color} text-xl mr-2`;
            questionTypeIndicator.className = `bg-white rounded-xl shadow-lg p-3 w-[45%] flex items-center justify-center card-hover ${config.color.replace('text-', 'border-')} border-2`;
        }

        // 生成数学问题
        function generateMathQuestion() {
            // 随机选择数学运算类型
            const operations = ['addition', 'subtraction', 'multiplication', 'division', 'percentage', 'fraction'];
            const operation = operations[Math.floor(Math.random() * operations.length)];
            
            let num1, num2, answer, questionText, options;
            
            // 根据难度设置数字范围
            const difficultyRanges = {
                easy: { min: 1, max: 10 },
                medium: { min: 10, max: 50 },
                hard: { min: 50, max: 100 }
            };
            
            const { min, max } = difficultyRanges[gameState.difficulty];
            
            // 根据运算类型生成题目
            switch (operation) {
                case 'addition':
                    num1 = Math.floor(Math.random() * (max - min + 1)) + min;
                    num2 = Math.floor(Math.random() * (max - min + 1)) + min;
                    answer = num1 + num2;
                    questionText = `${num1} + ${num2} = ?`;
                    break;
                case 'subtraction':
                    // 确保结果为正数
                    num1 = Math.floor(Math.random() * (max - min + 1)) + min;
                    num2 = Math.floor(Math.random() * (num1 - min + 1)) + min;
                    answer = num1 - num2;
                    questionText = `${num1} - ${num2} = ?`;
                    break;
                case 'multiplication':
                    // 减小乘法的数值范围
                    const multMin = gameState.difficulty === 'easy' ? 2 : 
                                   gameState.difficulty === 'medium' ? 5 : 10;
                    const multMax = gameState.difficulty === 'easy' ? 10 : 
                                   gameState.difficulty === 'medium' ? 20 : 30;
                    num1 = Math.floor(Math.random() * (multMax - multMin + 1)) + multMin;
                    num2 = Math.floor(Math.random() * (multMax - multMin + 1)) + multMin;
                    answer = num1 * num2;
                    questionText = `${num1} × ${num2} = ?`;
                    break;
                case 'division':
                    // 确保能整除
                    num2 = Math.floor(Math.random() * (10 - 2 + 1)) + 2; // 2-10的除数
                    const quotient = Math.floor(Math.random() * (max/num2 - min/num2 + 1)) + min/num2;
                    num1 = num2 * quotient;
                    answer = quotient;
                    questionText = `${num1} ÷ ${num2} = ?`;
                    break;
                case 'percentage':
                    num1 = Math.floor(Math.random() * (100 - 10 + 1)) + 10;
                    num2 = Math.floor(Math.random() * (100 - 1 + 1)) + 1;
                    answer = Math.round(num1 * num2 / 100);
                    questionText = `${num1}% 的 ${num2} 是多少?`;
                    break;
                default:
                    num1 = Math.floor(Math.random() * (10 - 1 + 1)) + 1;
                    num2 = Math.floor(Math.random() * (10 - 1 + 1)) + 1;
                    answer = num1 + num2;
                    questionText = `${num1} + ${num2} = ?`;
            }
            
            // 生成干扰选项
            options = [answer];
            while (options.length < 3) {
                let wrongAnswer;
                do {
                    // 根据答案大小生成合理的干扰选项
                    const range = Math.max(1, Math.floor(answer * 0.2));
                    wrongAnswer = answer + (Math.floor(Math.random() * (range * 2 + 1)) - range);
                    if (wrongAnswer === answer) wrongAnswer += (Math.random() > 0.5 ? 1 : -1);
                } while (options.includes(wrongAnswer) || wrongAnswer < 0);
                options.push(wrongAnswer);
            }
            
            return {
                question: questionText,
                answer: answer.toString(),
                options: options.map(String)
            };
        }

        // 生成逻辑问题
        function generateLogicQuestion() {
            const logicQuestions = [
                {
                    question: "有一个房间，里面有3盏灯，外面有3个开关。你只能进入房间一次，如何确定哪个开关控制哪盏灯？",
                    answer: "先打开第一个开关，等几分钟后关闭，再打开第二个开关，然后进入房间。亮着的灯由第二个开关控制，发热但不亮的灯由第一个开关控制，剩下的灯由第三个开关控制。",
                    requiresInput: true
                },
                {
                    question: "一个人在漆黑的房间里能看到东西吗？",
                    answer: "不能",
                    options: ["能", "不能", "有时能"]
                },
                {
                    question: "如果5只猫5分钟能捉5只老鼠，那么100只猫捉100只老鼠需要多长时间？",
                    answer: "5分钟",
                    options: ["5分钟", "10分钟", "100分钟"]
                },
                {
                    question: "一个家庭有两个孩子，其中一个是男孩，另一个也是男孩的概率是多少？",
                    answer: "1/3",
                    options: ["1/2", "1/3", "1/4"]
                },
                {
                    question: "有10个袋子，每个袋子有10枚金币，其中9个袋子里的金币每个重10克，只有一个袋子里的金币每个重9克。如何只称一次就找出那个装9克金币的袋子？",
                    answer: "从第1个袋子取1枚，第2个取2枚...第10个取10枚，一起称重。总重量比550克少几克，就是第几个袋子。",
                    requiresInput: true
                }
            ];
            
            // 随机选择一个问题
            const question = logicQuestions[Math.floor(Math.random() * logicQuestions.length)];
            
            if (question.requiresInput) {
                return {
                    question: question.question,
                    answer: question.answer.toLowerCase()
                };
            } else {
                return {
                    question: question.question,
                    answer: question.answer,
                    options: question.options
                };
            }
        }

        // 生成脑筋急转弯问题
        function generateTriviaQuestion() {
            const triviaQuestions = [
                {
                    question: "什么东西越洗越脏？",
                    answer: "水",
                    options: ["水", "肥皂", "衣服"]
                },
                {
                    question: "什么东西有五个头，但人不觉得它怪呢？",
                    answer: "手或脚",
                    options: ["手或脚", "怪物", "手套"]
                },
                {
                    question: "什么东西晚上才会长出尾巴？",
                    answer: "流星",
                    options: ["流星", "月亮", "松鼠"]
                },
                {
                    question: "什么东西越热越爱出来？",
                    answer: "汗",
                    options: ["汗", "冰淇淋", "太阳"]
                },
                {
                    question: "什么东西人们在不停地吃它，却永远吃不饱？",
                    answer: "空气",
                    options: ["空气", "水", "零食"]
                },
                {
                    question: "什么东西能加不能减？",
                    answer: "年龄",
                    options: ["年龄", "体重", "钱"]
                }
            ];
            
            // 随机选择一个问题
            const question = triviaQuestions[Math.floor(Math.random() * triviaQuestions.length)];
            return {
                question: question.question,
                answer: question.answer,
                options: question.options
            };
        }

        // 生成文字理解问题
        function generateWordQuestion() {
            const wordQuestions = [
                {
                    question: "请找出与'高兴'意思最相近的词",
                    answer: "快乐",
                    options: ["快乐", "悲伤", "愤怒"]
                },
                {
                    question: "请找出与'巨大'意思相反的词",
                    answer: "微小",
                    options: ["微小", "高大", "广阔"]
                },
                {
                    question: "'画蛇添足'这个成语的意思是？",
                    answer: "做了多余的事，反而不合适",
                    options: [
                        "做了多余的事，反而不合适",
                        "画画技巧高超",
                        "蛇的样子很奇怪"
                    ]
                },
                {
                    question: "'一箭双雕'这个成语比喻什么？",
                    answer: "做一件事达到两个目的",
                    options: [
                        "做一件事达到两个目的",
                        "射箭技术高超",
                        "雕的数量很多"
                    ]
                },
                {
                    question: "下列哪个词语是描写天气的？",
                    answer: "晴空万里",
                    options: ["晴空万里", "眉清目秀", "四面八方"]
                }
            ];
            
            // 随机选择一个问题
            const question = wordQuestions[Math.floor(Math.random() * wordQuestions.length)];
            return {
                question: question.question,
                answer: question.answer,
                options: question.options
            };
        }

        // 生成生活常识问题
        function generateLifeQuestion() {
            const lifeQuestions = [
                {
                    question: "煮鸡蛋时，如何更容易剥壳？",
                    answer: "煮好后放入冷水中",
                    options: [
                        "煮好后放入冷水中",
                        "煮的时候加醋",
                        "煮的时间越长越好"
                    ]
                },
                {
                    question: "哪种食物富含维生素C？",
                    answer: "橙子",
                    options: ["橙子", "牛肉", "米饭"]
                },
                {
                    question: "家用电器着火时，首先应该做什么？",
                    answer: "切断电源",
                    options: ["切断电源", "用水浇灭", "用布盖住"]
                },
                {
                    question: "下列哪种做法有助于节约用水？",
                    answer: "用洗菜水浇花",
                    options: [
                        "用洗菜水浇花",
                        "开着水龙头刷牙",
                        "频繁冲洗马桶"
                    ]
                },
                {
                    question: "正常成年人的体温大约是多少？",
                    answer: "37℃左右",
                    options: ["37℃左右", "35℃左右", "39℃左右"]
                }
            ];
            
            // 随机选择一个问题
            const question = lifeQuestions[Math.floor(Math.random() * lifeQuestions.length)];
            return {
                question: question.question,
                answer: question.answer,
                options: question.options
            };
        }

        // 生成趣味推理问题
        function generateFunQuestion() {
            const funQuestions = [
                {
                    question: "一个人在雨中行走，为什么他的头发没有湿？",
                    answer: "他是光头",
                    options: ["他是光头", "他带了伞", "雨不大"]
                },
                {
                    question: "为什么自由女神像总是站在纽约港？",
                    answer: "因为她不能坐下",
                    options: [
                        "因为她不能坐下",
                        "那是她的工作岗位",
                        "为了方便游客参观"
                    ]
                },
                {
                    question: "什么东西买的人知道，卖的人也知道，只有用的人不知道？",
                    answer: "棺材",
                    options: ["棺材", "礼物", "药品"]
                },
                {
                    question: "为什么数学书总是很忧郁？",
                    answer: "因为它有太多的问题",
                    options: [
                        "因为它有太多的问题",
                        "它很难懂",
                        "它很厚重"
                    ]
                },
                {
                    question: "什么东西当你说到它的名字，就把它打破了？",
                    answer: "沉默",
                    options: ["沉默", "玻璃", "气球"]
                }
            ];
            
            // 随机选择一个问题
            const question = funQuestions[Math.floor(Math.random() * funQuestions.length)];
            return {
                question: question.question,
                answer: question.answer,
                options: question.options
            };
        }

        // 生成数字推理问题
        function generateNumberSequenceQuestion() {
            const sequences = [
                {
                    question: "找出数列中的下一个数字：1, 3, 5, 7, ?",
                    answer: "9",
                    options: ["9", "10", "8"]
                },
                {
                    question: "找出数列中的下一个数字：2, 4, 8, 16, ?",
                    answer: "32",
                    options: ["32", "24", "30"]
                },
                {
                    question: "找出数列中的下一个数字：1, 1, 2, 3, 5, 8, ?",
                    answer: "13",
                    options: ["13", "12", "15"]
                },
                {
                    question: "找出数列中的下一个数字：10, 9, 7, 4, ?",
                    answer: "0",
                    options: ["0", "1", "2"]
                },
                {
                    question: "找出数列中的下一个数字：1, 4, 9, 16, 25, ?",
                    answer: "36",
                    options: ["36", "30", "42"]
                }
            ];
            
            // 随机选择一个问题
            const question = sequences[Math.floor(Math.random() * sequences.length)];
            return {
                question: question.question,
                answer: question.answer,
                options: question.options
            };
        }

        // 检查选项答案
        function checkAnswer(e) {
            if (!gameState.isPlaying) return;
            
            clearInterval(gameState.timerInterval);
            const selectedAnswer = e.target.textContent;
            
            // 禁用所有选项按钮
            optionButtons.forEach(button => {
                button.disabled = true;
                if (button.textContent === gameState.currentQuestion.answer) {
                    button.classList.remove(questionTypeConfig[gameState.currentQuestion.type].buttonColor);
                    button.classList.add('bg-secondary');
                } else if (button === e.target) {
                    button.classList.remove(questionTypeConfig[gameState.currentQuestion.type].buttonColor);
                    button.classList.add('bg-danger');
                } else {
                    button.classList.add('opacity-70');
                }
            });
            
            // 判断答案是否正确
            if (selectedAnswer === gameState.currentQuestion.answer) {
                handleCorrectAnswer();
            } else {
                handleWrongAnswer();
            }
        }

        // 检查输入答案
        function checkInputAnswer() {
            if (!gameState.isPlaying || !inputAnswer.value.trim()) return;
            
            clearInterval(gameState.timerInterval);
            const userAnswer = inputAnswer.value.trim().toLowerCase();
            
            // 判断答案是否正确（考虑一些常见的同义表达）
            if (userAnswer === gameState.currentQuestion.answer.toLowerCase() ||
                (gameState.currentQuestion.answer.includes("或") && 
                 gameState.currentQuestion.answer.toLowerCase().split("或").some(ans => userAnswer === ans.trim()))) {
                handleCorrectAnswer();
            } else {
                handleWrongAnswer();
            }
            
            // 禁用输入和提交按钮
            inputAnswer.disabled = true;
            submitAnswer.disabled = true;
        }

        // 处理正确答案
        function handleCorrectAnswer() {
            gameState.score += 10 + gameState.timeLeft; // 得分基于剩余时间
            gameState.correctAnswers++;
            updateScore();
            
            feedbackDisplay.textContent = "正确！";
            feedbackDisplay.className = "text-center h-10 mb-4 text-secondary font-bold fade-in";
            
            // 延迟生成下一题
            setTimeout(() => {
                inputAnswer.disabled = false;
                submitAnswer.disabled = false;
                generateQuestion();
                startTimer();
            }, 1000);
        }

        // 处理错误答案
        function handleWrongAnswer() {
            gameState.wrongAnswers++;
            
            feedbackDisplay.textContent = `错误！正确答案是: ${gameState.currentQuestion.answer}`;
            feedbackDisplay.className = "text-center h-10 mb-4 text-danger font-bold fade-in";
            
            // 如果错误次数达到3次，游戏结束
            if (gameState.wrongAnswers >= 3) {
                endGame();
            } else {
                // 延迟生成下一题
                setTimeout(() => {
                    inputAnswer.disabled = false;
                    submitAnswer.disabled = false;
                    generateQuestion();
                    startTimer();
                }, 2000);
            }
        }

        // 结束游戏
        function endGame() {
            gameState.isPlaying = false;
            clearInterval(gameState.timerInterval);
            
            // 更新游戏结束模态框
            finalScoreDisplay.textContent = gameState.score;
            correctAnswersDisplay.textContent = gameState.correctAnswers;
            wrongAnswersDisplay.textContent = gameState.wrongAnswers;
            
            // 显示游戏结束模态框
            gameOverModal.classList.remove('hidden');
            setTimeout(() => {
                gameOverContent.classList.remove('scale-95', 'opacity-0');
                gameOverContent.classList.add('scale-100', 'opacity-100');
            }, 10);
            
            // 重置按钮状态
            startBtn.classList.remove('hidden');
            restartBtn.classList.add('hidden');
        }

        // 初始化游戏
        function initGame() {
            initEventListeners();
            difficultyDisplay.textContent = gameState.difficulty.charAt(0).toUpperCase() + gameState.difficulty.slice(1);
            timerDisplay.textContent = gameState.timeLeft;
        }

        // 页面加载完成后初始化游戏
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
